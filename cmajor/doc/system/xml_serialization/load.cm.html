<div class="code">
<span class="line">
<span class="comment">// load.cm:</span>
<br/>
</span>
<span class="line">
<br/>
</span>
<span class="line">
<span class="keyword">using</span>&nbsp;<span class="identifier">System</span><span class="other">;</span><br/>
</span>
<span class="line">
<span class="keyword">using</span>&nbsp;<span class="identifier">System</span><span class="other">.</span><span class="identifier">IO</span><span class="other">;</span><br/>
</span>
<span class="line">
<span class="keyword">using</span>&nbsp;<span class="identifier">System</span><span class="other">.</span><span class="identifier">Collections</span><span class="other">;</span><br/>
</span>
<span class="line">
<span class="keyword">using</span>&nbsp;<span class="identifier">System</span><span class="other">.</span><span class="identifier">Xml</span><span class="other">.</span><span class="identifier">Serialization</span><span class="other">;</span><br/>
</span>
<span class="line">
<br/>
</span>
<span class="line">
<span class="keyword">namespace</span>&nbsp;<span class="identifier">model</span><br/>
</span>
<span class="line">
<span class="other">{</span><br/>
</span>
<span class="line">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span>&nbsp;<span class="identifier">UniquePtr</span><span class="other">&lt;</span><span class="identifier">Person</span><span class="other">&gt;</span>&nbsp;<span class="identifier">Load</span><span class="other">(</span><span class="keyword">const</span>&nbsp;<span class="identifier">string</span><span class="other">&amp;</span>&nbsp;<span class="identifier">fileName</span><span class="other">)</span><br/>
</span>
<span class="line">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="other">{</span><br/>
</span>
<span class="line">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">string</span>&nbsp;<span class="identifier">xmlStr</span>&nbsp;<span class="other">=</span>&nbsp;<span class="identifier">File</span><span class="other">.</span><span class="identifier">ReadAllText</span><span class="other">(</span><span class="identifier">fileName</span><span class="other">)</span><span class="other">;</span><br/>
</span>
<span class="line">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">UniquePtr</span><span class="other">&lt;</span><span class="identifier">XmlBundle</span><span class="other">&gt;</span>&nbsp;<span class="identifier">bundle</span>&nbsp;<span class="other">=</span>&nbsp;<span class="identifier">ToXmlBundle</span><span class="other">(</span><span class="identifier">xmlStr</span><span class="other">,</span>&nbsp;<span class="identifier">fileName</span><span class="other">)</span><span class="other">;</span><br/>
</span>
<span class="line">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">UniqueXmlPtr</span><span class="other">&lt;</span><span class="identifier">Person</span><span class="other">&gt;</span>&nbsp;<span class="identifier">root</span>&nbsp;<span class="other">=</span>&nbsp;<span class="identifier">XmlCast</span><span class="other">&lt;</span><span class="identifier">Person</span><span class="other">&gt;</span><span class="other">(</span><span class="identifier">bundle</span><span class="other">.</span><span class="identifier">Root</span><span class="other">(</span><span class="other">)</span><span class="other">)</span><span class="other">;</span><br/>
</span>
<span class="line">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="other">(</span><span class="identifier">root</span><span class="other">.</span><span class="identifier">IsNull</span><span class="other">(</span><span class="other">)</span><span class="other">)</span><br/>
</span>
<span class="line">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="other">{</span><br/>
</span>
<span class="line">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">throw</span>&nbsp;<span class="identifier">Exception</span><span class="other">(</span><span class="string">&quot;Person expected&quot;</span><span class="other">)</span><span class="other">;</span><br/>
</span>
<span class="line">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="other">}</span><br/>
</span>
<span class="line">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">root</span><span class="other">;</span><br/>
</span>
<span class="line">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="other">}</span><br/>
</span>
<span class="line">
<span class="other">}</span><br/>
</span>
</div>
