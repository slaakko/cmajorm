// =================================
// Copyright (c) 2020 Seppo Laakko
// Distributed under the MIT license
// =================================

using System;

namespace System.Windows
{
    public const byte VK_LBUTTON = 0x01u;
    public const byte VK_RBUTTON = 0x02u;
    public const byte VK_CANCEL = 0x03u;
    public const byte VK_MBUTTON = 0x04u;
    public const byte VK_XBUTTON1 = 0x05u;
    public const byte VK_XBUTTON2 = 0x06u;
    public const byte VK_BACK = 0x08u;
    public const byte VK_TAB = 0x09u;
    public const byte VK_CLEAR = 0x0Cu;
    public const byte VK_RETURN = 0x0Du;
    public const byte VK_SHIFT = 0x10u;
    public const byte VK_CONTROL = 0x11u;
    public const byte VK_MENU = 0x12u;
    public const byte VK_PAUSE = 0x13u;
    public const byte VK_CAPITAL = 0x14u;
    public const byte VK_KANA = 0x15u;
    public const byte VK_HANGUEL = 0x15u;
    public const byte VK_HANGUL = 0x15u;
    public const byte VK_IME_ON = 0x16u;
    public const byte VK_JUNJA = 0x17u;
    public const byte VK_FINAL = 0x18u;
    public const byte VK_HANJA = 0x19u;
    public const byte VK_KANJI = 0x19u;
    public const byte VK_IME_OFF = 0x1Au;
    public const byte VK_ESCAPE = 0x1Bu;
    public const byte VK_CONVERT = 0x1Cu;
    public const byte VK_NONCONVERT = 0x1Du;
    public const byte VK_ACCEPT = 0x1Eu;
    public const byte VK_MODECHANGE = 0x1Fu;
    public const byte VK_SPACE = 0x20u;
    public const byte VK_PRIOR = 0x21u; // PAGE UP
    public const byte VK_NEXT = 0x22u; // PAGE DOWN
    public const byte VK_END = 0x23u;
    public const byte VK_HOME = 0x24u;
    public const byte VK_LEFT = 0x25u;
    public const byte VK_UP = 0x26u;
    public const byte VK_RIGHT = 0x27u;
    public const byte VK_DOWN = 0x28u;
    public const byte VK_SELECT = 0x29u;
    public const byte VK_PRINT = 0x2Au;
    public const byte VK_EXECUTE = 0x2Bu;
    public const byte VK_SNAPSHOT = 0x2Cu;
    public const byte VK_INSERT = 0x2Du;
    public const byte VK_DELETE = 0x2Eu;
    public const byte VK_HELP = 0x2Fu;
    public const byte VK_0 = 0x30u;
    public const byte VK_1 = 0x31u;
    public const byte VK_2 = 0x32u;
    public const byte VK_3 = 0x33u;
    public const byte VK_4 = 0x34u;
    public const byte VK_5 = 0x35u;
    public const byte VK_6 = 0x36u;
    public const byte VK_7 = 0x37u;
    public const byte VK_8 = 0x38u;
    public const byte VK_9 = 0x39u;
    public const byte VK_A = 0x41u;
    public const byte VK_B = 0x42u;
    public const byte VK_C = 0x43u;
    public const byte VK_D = 0x44u;
    public const byte VK_E = 0x45u;
    public const byte VK_F = 0x46u;
    public const byte VK_G = 0x47u;
    public const byte VK_H = 0x48u;
    public const byte VK_I = 0x49u;
    public const byte VK_J = 0x4Au;
    public const byte VK_K = 0x4Bu;
    public const byte VK_L = 0x4Cu;
    public const byte VK_M = 0x4Du;
    public const byte VK_N = 0x4Eu;
    public const byte VK_O = 0x4Fu;
    public const byte VK_P = 0x50u;
    public const byte VK_Q = 0x51u;
    public const byte VK_R = 0x52u;
    public const byte VK_S = 0x53u;
    public const byte VK_T = 0x54u;
    public const byte VK_U = 0x55u;
    public const byte VK_V = 0x56u;
    public const byte VK_W = 0x57u;
    public const byte VK_X = 0x58u;
    public const byte VK_Y = 0x59u;
    public const byte VK_Z = 0x5Au;
    public const byte VK_LWIN = 0x5Bu;
    public const byte VK_RWIN = 0x5Cu;
    public const byte VK_APPS = 0x5Du;
    public const byte VK_SLEEP = 0x5Fu;
    public const byte VK_NUMPAD0 = 0x60u;
    public const byte VK_NUMPAD1 = 0x61u;
    public const byte VK_NUMPAD2 = 0x62u;
    public const byte VK_NUMPAD3 = 0x63u;
    public const byte VK_NUMPAD4 = 0x64u;
    public const byte VK_NUMPAD5 = 0x65u;
    public const byte VK_NUMPAD6 = 0x66u;
    public const byte VK_NUMPAD7 = 0x67u;
    public const byte VK_NUMPAD8 = 0x68u;
    public const byte VK_NUMPAD9 = 0x69u;
    public const byte VK_MULTIPLY = 0x6Au;
    public const byte VK_ADD = 0x6Bu;
    public const byte VK_SEPARATOR = 0x6Cu;
    public const byte VK_SUBTRACT = 0x6Du;
    public const byte VK_DECIMAL = 0x6Eu;
    public const byte VK_DIVIDE = 0x6Fu;
    public const byte VK_F1 = 0x70u;
    public const byte VK_F2 = 0x71u;
    public const byte VK_F3 = 0x72u;
    public const byte VK_F4 = 0x73u;
    public const byte VK_F5 = 0x74u;
    public const byte VK_F6 = 0x75u;
    public const byte VK_F7 = 0x76u;
    public const byte VK_F8 = 0x77u;
    public const byte VK_F9 = 0x78u;
    public const byte VK_F10 = 0x79u;
    public const byte VK_F11 = 0x7Au;
    public const byte VK_F12 = 0x7Bu;
    public const byte VK_F13 = 0x7Cu;
    public const byte VK_F14 = 0x7Du;
    public const byte VK_F15 = 0x7Eu;
    public const byte VK_F16 = 0x7Fu;
    public const byte VK_F17 = 0x80u;
    public const byte VK_F18 = 0x81u;
    public const byte VK_F19 = 0x82u;
    public const byte VK_F20 = 0x83u;
    public const byte VK_F21 = 0x84u;
    public const byte VK_F22 = 0x85u;
    public const byte VK_F23 = 0x86u;
    public const byte VK_F24 = 0x87u;
    public const byte VK_NUMLOCK = 0x90u;
    public const byte VK_SCROLL = 0x91u;
    public const byte VK_LSHIFT = 0xA0u;
    public const byte VK_RSHIFT = 0xA1u;
    public const byte VK_LCONTROL = 0xA2u;
    public const byte VK_RCONTROL = 0xA3u;
    public const byte VK_LMENU = 0xA4u;
    public const byte VK_RMENU = 0xA5u;
    public const byte VK_BROWSER_BACK = 0xA6u;
    public const byte VK_BROWSER_FORWARD = 0xA7u;
    public const byte VK_BROWSER_REFRESH = 0xA8u;
    public const byte VK_BROWSER_STOP = 0xA9u;
    public const byte VK_BROWSER_SEARCH = 0xAAu;
    public const byte VK_BROWSER_FAVORITES = 0xABu;
    public const byte VK_BROWSER_HOME = 0xACu;
    public const byte VK_VOLUME_MUTE = 0xADu;
    public const byte VK_VOLUME_DOWN = 0xAEu;
    public const byte VK_VOLUME_UP = 0xAFu;
    public const byte VK_MEDIA_NEXT_TRACK = 0xB0u;
    public const byte VK_MEDIA_PREV_TRACK = 0xB1u;
    public const byte VK_MEDIA_STOP = 0xB2u;
    public const byte VK_MEDIA_PLAY_PAUSE = 0xB3u;
    public const byte VK_LAUNCH_MAIL = 0xB4u;
    public const byte VK_LAUNCH_MEDIA_SELECT = 0xB5u;
    public const byte VK_LAUNCH_APP1 = 0xB6u;
    public const byte VK_LAUNCH_APP2 = 0xB7u;
    public const byte VK_OEM_1 = 0xBAu;
    public const byte VK_OEM_PLUS = 0xBBu;
    public const byte VK_OEM_COMMA = 0xBCu;
    public const byte VK_OEM_MINUS = 0xBDu;
    public const byte VK_OEM_PEDIOD = 0xBEu;
    public const byte VK_OEM_2 = 0xBFu;
    public const byte VK_OEM_3 = 0xC0u;
    public const byte VK_OEM_4 = 0xDBu;
    public const byte VK_OEM_5 = 0xDCu;
    public const byte VK_OEM_6 = 0xDDu;
    public const byte VK_OEM_7 = 0xDEu;
    public const byte VK_OEM_8 = 0xDFu;
    public const byte VK_OEM_102 = 0xE2u;
    public const byte VK_PROCESSKEY = 0xE5u;
    public const byte VK_PACKET = 0xE7u;
    public const byte VK_ATTN = 0xF6u;
    public const byte VK_CRSEL = 0xF7u;
    public const byte VK_EXSEL = 0xF8u;
    public const byte VK_PLAY = 0xFAu;
    public const byte VK_ZOOM = 0xFBu;
    public const byte VK_PA1 = 0xFDu;
    public const byte VK_OEM_CLEAR = 0xFEu;

    public enum Keys : int
    {
        a = 65,
        add = 107,
        altModifier = 262144, // 0x0004 0000 ALT modifier key
        apps = 93,
        attn = 246,
        b = 66,
        back = 8,
        browserBack = 166,
        browserFavorites = 171,
        browserForward = 167,
        browserHome = 172,
        browserRefresh = 168,
        browserSearch = 170,
        browserStop = 169,
        c = 67,
        cancel = 3,
        capital = 20,
        capsLock = 20,
        clear = 12,
        controlModifier = 131072, // 0x0002 0000 CTRL modifier key
        controlKey = 17, // CTRL key
        crsel = 247,
        d = 68,
        d0 = 48,
        d1 = 49,
        d2 = 50,
        d3 = 51,
        d4 = 52,
        d5 = 53,
        d6 = 54,
        d7 = 55,
        d8 = 56,
        d9 = 57,
        decimal = 110,
        delete_ = 46,
        divide = 111,
        down = 40,
        e = 69,
        end = 35,
        enter = 13,
        eraseEof = 249,
        escape = 27,
        execute = 43,
        exsel = 248,
        f = 70,
        f1 = 112,
        f10 = 121,
        f11 = 122,
        f12 = 123,
        f13 = 124,
        f14 = 125,
        f15 = 126,
        f16 = 127,
        f17 = 128,
        f18 = 129,
        f19 = 130,
        f2 = 113,
        f20 = 131,
        f21 = 132,
        f22 = 133,
        f23 = 134,
        f24 = 135,
        f3 = 114,
        f4 = 115,
        f5 = 116,
        f6 = 117,
        f7 = 118,
        f8 = 119,
        f9 = 120,
        finalMode = 24,
        g = 71,
        h = 72,
        hanguelMode = 21,
        hangulMode = 21,
        hanjaMode = 25,
        help = 47,
        home = 36,
        i = 73,
        imeAccept = 30,
        imeConvert = 28,
        imeModeChange = 31,
        imeNonconvert = 29,
        insert = 45,
        j = 74,
        junjaMode = 23,
        k = 75,
        kanaMode = 21,
        kanjiMode = 25,
        keyCode = 65535,
        l = 75,
        launchApplication1 = 182,
        launchApplication2 = 183,
        launchMail = 180,
        lButton = 1,
        lControlKey = 162, // LEFT CTRL KEY
        left = 37,
        lineFeed = 10,
        lMenu = 164, // LEFT ALT KEY
        lShiftKey = 160, // LEFT SHIFT KEY
        lWin = 91,
        m = 77,
        mButton = 4,
        mediaNextTrack = 176,
        mediaPlayPause = 179,
        mediaPreviousTrack = 177,
        mediaStop = 178,
        menu = 18, // ALT KEY
        modifiers = -65536,
        multiply = 106,
        n = 78,
        next = 34, // PAGE DOWN
        noName = 252,
        none = 0,
        numLock = 144,
        numPad0 = 96,
        numPad1 = 97,
        numPad2 = 98,
        numPad3 = 99,
        numPad4 = 100,
        numPad5 = 101,
        numPad6 = 102,
        numPad7 = 103,
        numPad8 = 104,
        numPad9 = 105,
        o = 79,
        oem1 = 186,
        oem102 = 226,
        oem2 = 191,
        oem3 = 192,
        oem4 = 219,
        oem5 = 220,
        oem6 = 221,
        oem7 = 222,
        oem8 = 223,
        oemBackslash = 226,
        oemClear = 254,
        oemCloseBrackets = 221,
        oemComma = 188,
        oemMinus = 189,
        oemOpenBrackets = 219,
        oemPediod = 190,
        oemPipe = 220,
        oemPlus = 187,
        oemQuestion = 191,
        oemQuotes = 222,
        oemSemicolon = 186,
        oemTilde = 192,
        p = 80,
        pa1 = 253,
        packet = 231,
        pageDown = 34,
        pageUp = 33,
        pause = 19,
        play = 250,
        print = 42,
        printScreen = 44,
        prior = 33,
        processKey = 229,
        q = 81,
        r = 82,
        rButton = 2,
        rControlKey = 163,
        return_ = 13,
        right = 39,
        rMenu = 165, // RIGHT ALT
        rShiftKey = 161, // RIGHT SHIFT
        rWin = 92,
        s = 83,
        scroll = 145,
        select = 41,
        selectMedia = 181,
        separator = 108,
        shiftModifier = 65536, // 0x0001 0000 SHIFT modifier key
        shiftKey = 16, // SHIFT key
        sleep = 95,
        snapshot = 44,
        space = 32,
        subtract = 109,
        t = 84,
        tab = 9,
        u = 85,
        up = 38,
        v = 86,
        volumeDown = 174,
        volumeMute = 173,
        volumeUp = 175,
        w = 87,
        x = 88,
        xButton1 = 5,
        xButton2 = 6,
        y = 89,
        z = 90,
        zoom = 251
    }

    public nothrow ulong GetHashCode(Keys keys)
    {
        return cast<ulong>(cast<int>(keys));
    }

    public const char*[] keyCodeStr =
    [
        "None",  
        "LButton", 
        "RButton",
        "Cancel",
        "MButton",
        "XBUtton1",
        "XButton2",
        "",
        "Backspace",
        "Tab", 
        "",
        "",
        "Clear",
        "Enter", 
        "",
        "",
        "Shift",
        "Control",
        "Alt",
        "Pause",
        "Caps Lock",
        "Kana",
        "IME On",
        "Junja",
        "Final",
        "Hanja",
        "IME Off",
        "Escape",
        "Convert",
        "Nonconvert",
        "Accept",
        "Mode change",
        "Space",
        "Page up",
        "Page down",
        "End",
        "Home",
        "Left",
        "Up",
        "Right",
        "Down",
        "Select",
        "Print",
        "Execute",
        "Snapshot",
        "Insert",
        "Delete",
        "Help",
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7",
        "8",
        "9", 
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "A",
        "B",
        "C",
        "D",
        "E",
        "F",
        "G",
        "H",
        "I",
        "J",
        "K",
        "L",
        "M",
        "N",
        "O",
        "P",
        "Q",
        "R",
        "S",
        "T",
        "U",
        "V",
        "W",
        "X",
        "Y",
        "Z",
        "Left Windows",
        "Right Windows",
        "Apps",
        "",
        "Sleep",
        "Num pad 0",
        "Num pad 1",
        "Num pad 2",
        "Num pad 3",
        "Num pad 4",
        "Num pad 5",
        "Num pad 6",
        "Num pad 7",
        "Num pad 8",
        "Num pad 9",
        "Multiply",
        "Add",
        "Separator",
        "Subtract",
        "Decimal",
        "Divide",
        "F1",
        "F2",
        "F3",
        "F4",
        "F5",
        "F6",
        "F7",
        "F8",
        "F9",
        "F10",
        "F11",
        "F12",
        "F13",
        "F14",
        "F15",
        "F16",
        "F17",
        "F18",
        "F19",
        "F20",
        "F21",
        "F22",
        "F23",
        "F24",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Num Lock",
        "Scroll Lock",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Left Shift",
        "Right Shift",
        "Left Control",
        "Right Control",
        "Left Alt",
        "Right Alt",
        "Browser Back",
        "Browser Forward",
        "Browser Refresh",
        "Browser Stop",
        "Browser Search",
        "Browser Favorites",
        "Browser Home",
        "Volume Mute",
        "Volume Down",
        "Volume Up",
        "Media Next Track",
        "Media Prev Track",
        "Media Stop",
        "Media Play Pause",
        "Launch Mail",
        "Launch Media Select",
        "Launch Application 1",
        "Launch Application 2",
        "",
        "",
        "OEM 1",
        "OEM Plus",
        "OEM Comma",
        "OEM Minus",
        "OEM Period",
        "OEM 2",
        "OEM 3",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "OEM 4",
        "OEM 5",
        "OEM 6",
        "OEM 7",
        "OEM 8",
        "",
        "",
        "OEM 102",
        "",
        "",
        "Process Key",
        "",
        "Packet",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Attention",
        "CR Select",
        "EX Select",
        "",
        "Play",
        "Zoom",
        "",
        "PA1",
        "OEM Clear"
    ];

    public nothrow string ToString(Keys keys)
    {
        string s;
        if ((keys & Keys.controlModifier) != 0)
        {
            s.Append("Ctrl+");
        }
        if ((keys & Keys.altModifier) != 0)
        {
            s.Append("Alt+");
        }
        if ((keys & Keys.shiftModifier) != 0)
        {
            s.Append("Shift+");
        }
        Keys keyCode = cast<Keys>(keys & ~Keys.modifiers);
        s.Append(keyCodeStr[cast<int>(keyCode)]);
        return s;
    }
}
