using System;
using System.Os;

int main()
{
    try
    {
        if (IsConsole(0))
        {
            bool prevEcho = Echo(0);
            string s;
            if (prevEcho)
            {
                s = "on";
            }
            else
            {
                s = "off";
            }
            Console.Out() << "echo is " << s << endl();
            SetEcho(0, false);
            bool echo = Echo(0);
            if (echo)
            {
                s = "on";
            }
            else
            {
                s = "off";
            }
            Console.Out() << "echo is " << s << endl();
            Console.Out() << "enter password: ";
            string password = Console.ReadLine();
            Console.Out() << "you entered: " << password << endl();
            SetEcho(0, prevEcho);
            echo = Echo(0);
            if (echo)
            {
                s = "on";
            }
            else
            {
                s = "off";
            }
            Console.Out() << "echo is " << s << endl();
        }
        else
        {
            throw Exception("input of echo cannot be redirected");
        }
    }
    catch (const Exception& ex)
    {
        Console.Error() << ex.Message() << endl();
        return 1;
    }
    return 0;
}
